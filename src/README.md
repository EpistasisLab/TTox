# This folder contains source code used by the repository.

## R/python scripts 

+ [`generate_learning_data.py`](generate_learning_data.py) generates feature-response datasets for learning task from group-sample relationships, then splits each dataset into train set and test set   

+ [`select_feature_by_cv.py`](select_feature_by_cv.py) implements ReBATE methods together with cross-validation to select relevant features, then evaluates model performance on hold-out testing set, eventually implements the model to predict responses of new instances. [`run/run_select_feature_by_cv_target_0.25_binary_tuning.R`](run/run_select_feature_by_cv_target_0.25_binary_tuning.R) generates shell scripts that run feature selection hyperparamter tuning on sampled subset of compound structure-target binding datasets. [`run/run_select_feature_by_cv_target_0.25_binary_implementation.R`](run/run_select_feature_by_cv_target_0.25_binary_implementation.R) generates shell scripts that implement feature selection on all compound structure-target binding datasets using the optimal hyperparameter settings. [`run/run_select_feature_by_cv_target_all_adverse_event.R`](run/run_select_feature_by_cv_target_all_adverse_event.R) generates shell scripts that implement feature selection pipeline on all compound target-adverse event datasets.

+ [`select_feature_by_regularization.py`](select_feature_by_regularization.py) builds L1 regularized classification/regression models to select relevant features, then evaluates model performance on hold-out testing set, eventually implements the model to predict responses of new instances. [`run/run_select_feature_by_regularization_target_0.25_binary_implementation.R`](run/run_select_feature_by_regularization_target_0.25_binary_implementation.R) generates shell scripts that implement L1 regularization on compound structure-target binding datasets.

+ [`collect_selection_results.R`](collect_selection_results.R) collects feature selection results of multiple datasets. [`run/run_collect_selection_results_target_all_adverse_event.R`](run/run_collect_selection_results_target_all_adverse_event.R) generates shell scripts that collects, analyzes, and visualizes feature selection results on compound target-adverse event datasets.

+ [`analyze_selection_results.py`](analyze_selection_results.py) analyzes and visualizes the results of feature selection pipeline.  

+ [`compare_bind_models.py`](compare_bind_models.py) compares and visualizes target-binding prediction models across distinct groups.

+ [`compare_tox_models.py`](compare_tox_models.py) compares and visulizes performance of distinct toxicity prediction models.

+ [`ttox_data.py`](ttox_data.py) contains functions for data pre-processing.

+ [`ttox_learning.py`](ttox_learning.py) contains functions for building, evaluating, and implementing machine learning models.

+ [`ttox_selection.py`](ttox_selection.py) contains functions for selecting relevant features by cross-validation.

+ [`ttox_sim.py`](ttox_sim.py) contains functions for computing structure similarity between compounds, and feature similarity between models.

+ [`ttox_plot.py`](ttox_plot.py) contains functions for visualizing feature selection results. 

+ [`functions.R`](functions.R) R functions required for other R scripts in the repository.

## Executable shell scripts

+ [`run/generate_learning_data_compound_structure_target_binary.sh`](run/generate_learning_data_compound_structure_target_binary.sh`) runs [`generate_learning_data.py`](generate_learning_data.py) on compound structure-target binding datasets from BindingDB and structure features of compounds. [`run/generate_learning_data_compound_structure_all_adverse_event.sh`](run/generate_learning_data_compound_structure_all_adverse_event.sh) runs [`generate_learning_data.py`](generate_learning_data.py) on compound structure-adverse event datasets from OFFSIDES and structure features of compounds. [`run/generate_learning_data_compound_target_all_adverse_event.sh`](run/generate_learning_data_compound_target_all_adverse_event.sh) runs [`generate_learning_data.py`](generate_learning_data.py) on compound target-adverse event datasets from OFFSIDES and target features of compounds.

+ [`run/run_select_feature_by_cv_target_0.25_binary_tuning.sh`](run/run_select_feature_by_cv_target_0.25_binary_tuning.sh) runs [`run/run_select_feature_by_cv_target_0.25_binary_tuning.R`](run/run_select_feature_by_cv_target_0.25_binary_tuning.R) on two types of compound structure-target binding datasets: chemical fingerprints and molecular descriptors. [`run/run_select_feature_by_cv_target_0.25_binary_implementation.sh`](run/run_select_feature_by_cv_target_0.25_binary_implementation.sh) runs [`run/run_select_feature_by_cv_target_0.25_binary_implementation.R`](run/run_select_feature_by_cv_target_0.25_binary_implementation.R) on two types of compound structure-target binding datasets: chemical fingerprints and molecular descriptors. [`run/run_select_feature_by_regularization_target_0.25_binary_implementation.sh`](run/run_select_feature_by_regularization_target_0.25_binary_implementation.sh) runs [`run/run_select_feature_by_regularization_target_0.25_binary_implementation.R`](run/run_select_feature_by_regularization_target_0.25_binary_implementation.R) on two types of compound structure-target binding datasets: chemical fingerprints and molecular descriptors.

+ [`run/select_feature_by_cv_target_0.25_binary_tuning_fingerprint_maccs.sh`](run/select_feature_by_cv_target_0.25_binary_tuning_fingerprint_maccs.sh) and [`run/select_feature_by_cv_target_0.25_binary_tuning_descriptor_all.sh`](run/select_feature_by_cv_target_0.25_binary_tuning_descriptor_all.sh) runs [`select_feature_by_cv.py`](select_feature_by_cv.py) on two types of compound structure-target binding datasets: chemical fingerprints and molecular descriptors, respectively, for the purpose of feature selection hyperparamter tuning. [`run/select_feature_by_cv_target_0.25_binary_implementation_fingerprint_maccs.sh`](run/select_feature_by_cv_target_0.25_binary_implementation_fingerprint_maccs.sh) and [`run/select_feature_by_cv_target_0.25_binary_implementation_descriptor_all.sh`](run/select_feature_by_cv_target_0.25_binary_implementation_descriptor_all.sh) run [`select_feature_by_cv.py`](select_feature_by_cv.py) on two types of compound structure-target binding datasets: chemical fingerprints and molecular descriptors, respectively, for the purpose of feature selection implementation. [`run/select_feature_by_regularization_target_0.25_binary_implementation_fingerprint_maccs.sh`](run/select_feature_by_regularization_target_0.25_binary_implementation_fingerprint_maccs.sh) and [`run/select_feature_by_regularization_target_0.25_binary_implementation_descriptor_all.sh`](run/select_feature_by_regularization_target_0.25_binary_implementation_descriptor_all.sh) run [`select_feature_by_regularization.py`](select_feature_by_regularization.py) on two types of compound structure-target binding datasets: chemical fingerprints and molecular descriptors, respectively, for the purpose of L1 regularization implementation. [`run/select_feature_by_cv_target_all_adverse_event_implementation.sh`](run/select_feature_by_cv_target_all_adverse_event_implementation.sh) runs [`select_feature_by_cv.py`](select_feature_by_cv.py) on all compound target-adverse event datasets, for the purpose of feature selection implementation.

+ [`run/collect_selection_results_target_0.25_binary_tuning.sh`](run/collect_selection_results_target_0.25_binary_tuning.sh) runs [`collect_selection_results.R`](collect_selection_results.R) on hyperparamter tuning results of selected compound structure-target binding datasets. [`run/collect_selection_results_target_0.25_binary_implementation.sh`](run/collect_selection_results_target_0.25_binary_implementation.sh) runs [`collect_selection_results.R`](collect_selection_results.R) on feature selection pipeline implementation results of all compound structure-target binding datasets. [`run/collect_selection_results_regularization_target_0.25_binary_implementation.sh`](run/collect_selection_results_regularization_target_0.25_binary_implementation.sh) runs [`collect_selection_results.R`](collect_selection_results.R) on L1 regularization implementation results of all compound structure-target binding datasets. [`run/collect_selection_results_target_all_adverse_event.sh`](run/collect_selection_results_target_all_adverse_event.sh) runs [`collect_selection_results.R`](collect_selection_results.R) on feature selection pipeline implementation results of all compound target-adverse event datasets.

+ [`run/analyze_selection_results_target_0.25_binary_tuning.sh`](run/analyze_selection_results_target_0.25_binary_tuning.sh) runs [`analyze_selection_results.py`](analyze_selection_results.py) on feature selection hyperparamter tuning results of compound structure-target binding datasets. [`run/analyze_selection_results_target_0.25_binary_implementation.sh`](run/analyze_selection_results_target_0.25_binary_implementation.sh) runs [`analyze_selection_results.py`](analyze_selection_results.py) on feature selection pipeline implementation results of all compound structure-target binding datasets. [`run/analyze_selection_results_target_all_adverse_event_tuning.sh`](run/analyze_selection_results_target_all_adverse_event_tuning.sh) uns [`analyze_selection_results.py`](analyze_selection_results.py) on feature selection pipeline implementation results of all compound target-adverse event datasets.

+ [`run/compare_bind_models.sh`](run/compare_bind_models.sh) runs [`compare_bind_models.py`](compare_bind_models.py) on feature selection analysis results of compound structure-target binding datasets.

+ [`run/compare_tox_models.sh`](run/compare_tox_models.sh) runs [`compare_tox_models.py`](compare_tox_models.py) on feature selection implementation results of all compound target-adverse event datasets.
